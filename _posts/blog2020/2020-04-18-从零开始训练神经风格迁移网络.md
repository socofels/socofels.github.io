---
layout: article
title: 从零开始训练神经风格迁移网络
tags: 深度学习 从零开始系列
aside:
  toc: true
article_header:
  type: cover
  image:
    src: assets/images/background/pic/sky.jpg
mathjax: true
mathjax_autoNumber: true
---
# 神经风格转化
## 什么是神经风格转化
- 将两张图片合成一张图片，这张图片同时表现了A图片的内容与B图片的风格，就好像用某位画家的风格画了一幅画。
- 例如：![neural_style_transfer](https://socofels.github.io/assets/images/blogimg/neural_style_transfer.jpg)
<!--more-->
## 怎么实现神经风格转化
- 准备两张图片，以上图为例子，一张是内容图片，一张是风格图片
- 选择一个CNN网络模型，抽取其中间层来表达图片
- 定义损失函数
    - 损失函数由两个部分组成,内容损失函数和风格损失函数，总的函数损失为
        - $$loss = \alpha * loss_{content}+\beta * loss_{style}$$
    - 内容损失函数$loss_{content}$
        - 我们从模型中任取一中间层l的激活值a，计算生成图片与内容图片的距离。C，G分表表示的是内容图片与生成图片
            - $$loss_{content} = \frac{1}{2}||a^{[l][C]}-a^{[l][G]}||$$
    - 风格损失函数$loss_{style}$
        - 风格函数不能直接用距离来表示，那么我们应该如何表示一张图片的风格呢？
        这里我们使用风格矩阵来表达一张图片的风格是什么样子的。
            - 什么是风格矩阵
                - 我们知道CNN网络能够提取特征。每一个滤波器提取不同的特征，如图所示。
        - $$loss_{style} = \frac{1}{2}||a^{[l][C]}-a^{[l][G]}||$$



---
